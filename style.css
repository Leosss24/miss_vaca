function crearFormulario(vaca) {
  const form = document.createElement('form')
  form.className = 'formulario'

  const campos = criterios.map(criterio => {
    const grupo = document.createElement('div')
    grupo.className = 'voto-grupo'
    grupo.dataset.criterio = criterio

    const label = document.createElement('label')
    label.textContent = criterio.toUpperCase()

    for (let i = 1; i <= 5; i++) {
      const btn = document.createElement('button')
      btn.type = 'button'
      btn.textContent = i
      btn.dataset.valor = i

      btn.addEventListener('click', () => {
        [...grupo.children].forEach(b => b.classList.remove('selected'))
        btn.classList.add('selected')
        grupo.dataset.valor = i
      })

      grupo.appendChild(btn)
    }

    return { label, grupo }
  })

  const titulo = document.createElement('h2')
  titulo.textContent = vaca

  const submit = document.createElement('button')
  submit.type = 'submit'
  submit.textContent = 'Votar'

  form.appendChild(titulo)
  campos.forEach(({ label, grupo }) => {
    form.appendChild(label)
    form.appendChild(grupo)
  })
  form.appendChild(submit)

  form.addEventListener('submit', async e => {
    e.preventDefault()

    const voto = { vaca }
    let incompleto = false

    criterios.forEach(c => {
      const grupo = form.querySelector(`.voto-grupo[data-criterio="${c}"]`)
      const valor = parseInt(grupo.dataset.valor)
      if (!valor) incompleto = true
      voto[c] = valor
    })

    if (incompleto) {
      alert('Por favor selecciona una puntuaciÃ³n para todos los criterios.')
      return
    }

    const { error } = await supabase.from('votos').insert([voto])
    if (error) {
      alert("Error al votar ðŸ˜ž")
      console.error(error)
    } else {
      alert(`Â¡Gracias por votar por ${vaca}! ðŸ„`)
      // Desactiva botones y submit
      form.querySelectorAll('button').forEach(b => b.disabled = true)
      await mostrarResultados()
    }
  })

  return form
}
